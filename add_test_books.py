#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–Ω–∏–≥ –≤ –±–∞–∑—É."""

from database import DatabaseManager

def main():
    # –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –±–∞–∑–µ
    db = DatabaseManager('telegram_books.db')
    
    # –°–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–Ω–∏–≥
    test_books = [
        ("–í–æ–π–Ω–∞ –∏ –º–∏—Ä", "–õ–µ–≤ –¢–æ–ª—Å—Ç–æ–π", "–†–æ–º–∞–Ω"),
        ("1984", "–î–∂–æ—Ä–¥–∂ –û—Ä—É—ç–ª–ª", "–ê–Ω—Ç–∏—É—Ç–æ–ø–∏—è"),
        ("–ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞", "–ú–∏—Ö–∞–∏–ª –ë—É–ª–≥–∞–∫–æ–≤", "–†–æ–º–∞–Ω"),
        ("–ü—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ", "–§—ë–¥–æ—Ä –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π", "–†–æ–º–∞–Ω"),
        ("–ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä –∏ —Ñ–∏–ª–æ—Å–æ—Ñ—Å–∫–∏–π –∫–∞–º–µ–Ω—å", "–î–∂–æ–∞–Ω –†–æ—É–ª–∏–Ω–≥", "–§—ç–Ω—Ç–µ–∑–∏"),
        ("–í–ª–∞—Å—Ç–µ–ª–∏–Ω –∫–æ–ª–µ—Ü", "–î–∂–æ–Ω –¢–æ–ª–∫–∏–Ω", "–§—ç–Ω—Ç–µ–∑–∏"),
        ("–ê–Ω–Ω–∞ –ö–∞—Ä–µ–Ω–∏–Ω–∞", "–õ–µ–≤ –¢–æ–ª—Å—Ç–æ–π", "–†–æ–º–∞–Ω"),
        ("–¢—Ä–∏ —Ç–æ–≤–∞—Ä–∏—â–∞", "–≠—Ä–∏—Ö –ú–∞—Ä–∏—è –†–µ–º–∞—Ä–∫", "–†–æ–º–∞–Ω"),
        ("–ú–∞–ª–µ–Ω—å–∫–∏–π –ø—Ä–∏–Ω—Ü", "–ê–Ω—Ç—É–∞–Ω –¥–µ –°–µ–Ω—Ç-–≠–∫–∑—é–ø–µ—Ä–∏", "–ü–æ–≤–µ—Å—Ç—å"),
        ("–®–µ—Ä–ª–æ–∫ –•–æ–ª–º—Å", "–ê—Ä—Ç—É—Ä –ö–æ–Ω–∞–Ω –î–æ–π–ª", "–î–µ—Ç–µ–∫—Ç–∏–≤"),
    ]
    
    print("üìö –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–Ω–∏–≥–∏...")
    
    for title, author, genre in test_books:
        try:
            book_id = db.add_book(title, author, genre)
            print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞: {title} (ID: {book_id})")
        except Exception as e:
            print(f"‚ö†Ô∏è  –û—à–∏–±–∫–∞ —Å '{title}': {e}")
    
    print(f"\nüìä –í—Å–µ–≥–æ –≤ –±–∞–∑–µ: {len(db.get_all_books())} –∫–Ω–∏–≥")
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∏—Å–∫–∞
    print("\nüîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∏—Å–∫–∞:")
    results = db.search_books("–¢–æ–ª—Å—Ç–æ–π")
    print(f"   –ù–∞–π–¥–µ–Ω–æ –∫–Ω–∏–≥ –¢–æ–ª—Å—Ç–æ–≥–æ: {len(results)}")
    for book in results:
        print(f"   - {book['title']}")

if __name__ == "__main__":
    main()
